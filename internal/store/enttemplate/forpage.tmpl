{{/* The line below tells Intellij/GoLand to enable the autocompletion based on the *gen.Graph type. */}}
{{/* gotype: entgo.io/ent/entc/gen.Graph */}}

{{ define "forPage" }}

{{/* Add the base header for the generated file */}}
{{ $pkg := base $.Config.Package }}
{{ template "header" $ }}


const ForPageDefaultPageSize = 10
const ForPageDefaultPage = 0

{{/* Loop over all nodes and add implement the "GoStringer" interface */}}
{{ range $n := $.Nodes }}
     {{ $querier := $n.QueryName }}
            {{ $queryReceiver := receiver $querier }}
                func ({{ $queryReceiver }} *{{ $querier }}) ForPage(page,pageSize *int) *{{ $querier }} {
                    var p,ps,o,l int
                    if page == nil {
                        p = ForPageDefaultPage
                    } else {
                        p = *page
                    }
                    if pageSize == nil {
                        ps = ForPageDefaultPageSize
                    } else {
                        ps = *pageSize
                    }
                    if p > 0{
                        o = (p-1) * ps
                    }
                    l = ps
                    return {{ $queryReceiver }}.Offset(o).Limit(l)
                }
     {{ end }}
{{ end }}